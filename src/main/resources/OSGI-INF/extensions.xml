<?xml version="1.0" encoding="UTF-8"?>

<component name="studio.extensions.tdelprat-SANDBOX" version="1.0.0">
  <require>org.nuxeo.runtime.started</require>
  <extension target="org.nuxeo.ecm.core.schema.TypeService" point="schema">
    <schema name="demotype" prefix="demotype" src="schemas/demotype.xsd"/>
    <schema name="demoSchema" prefix="ds" src="schemas/demoSchema.xsd"/>
  </extension>
  <extension target="org.nuxeo.ecm.core.schema.TypeService" point="doctype">
    <doctype name="demoType" extends="File">
      <schema name="demotype"/>
      <schema name="demoSchema"/>
    </doctype>
  </extension>
  <extension target="org.nuxeo.ecm.core.lifecycle.LifeCycleService" point="types">
    <types>
      <type name="demoType">default</type>
    </types>
  </extension>
  <extension target="org.nuxeo.ecm.platform.types.TypeService" point="types">
    <type id="demoType">
      <label>DemoType</label>
      <description></description>
      <default-view>view_documents</default-view>
      <layouts mode="create">
        <layout>compoundForm@create2</layout>
      </layouts>
      <layouts mode="edit">
        <layout>compoundForm@edit</layout>
      </layouts>
      <layouts mode="view">
        <layout>compoundForm@view</layout>
      </layouts>
    </type>
    <type id="Folder">
      <subtypes>
        <type>demoType</type>
      </subtypes>
    </type>
    <type id="Workspace">
      <subtypes>
        <type>demoType</type>
      </subtypes>
    </type>
  </extension>
  <extension target="org.nuxeo.ecm.core.versioning.VersioningService" point="versioningRules">
    <versioningRule typeName="demoType">
      <initialState major="0" minor="0"/>
      <options lifeCycleState="*">
        <none default="true"/>
        <minor/>
        <major/>
      </options>
    </versioningRule>
  </extension>
  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager" point="layouts">
    <layout name="complexListForm@create">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>complexList</widget>
        </row>
      </rows>
      <widget name="complexList" type="list">
        <labels>
          <label mode="any">ComplexList</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:complexList</field>
        </fields>
        <properties widgetMode="edit">
          <property name="hideSubLabels">true</property>
        </properties>
        <subWidgets>
          <widget name="sub0" type="text">
            <labels>
              <label mode="any">EntryLabel</label>
            </labels>
            <translated>false</translated>
            <fields>
              <field>entryLabel</field>
            </fields>
          </widget>
          <widget name="sub1" type="text">
            <labels>
              <label mode="any">EntryName</label>
            </labels>
            <translated>false</translated>
            <fields>
              <field>entryName</field>
            </fields>
          </widget>
          <widget name="sub2" type="text">
            <labels>
              <label mode="any">EntryTyp</label>
            </labels>
            <translated>false</translated>
            <fields>
              <field>entryTyp</field>
            </fields>
          </widget>
        </subWidgets>
      </widget>
    </layout>
    <layout name="complexListForm@edit">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>complexList</widget>
        </row>
      </rows>
      <widget name="complexList" type="list">
        <labels>
          <label mode="any">ComplexList</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:complexList</field>
        </fields>
        <properties widgetMode="edit">
          <property name="hideSubLabels">true</property>
        </properties>
        <subWidgets>
          <widget name="sub0" type="text">
            <labels>
              <label mode="any">EntryLabel</label>
            </labels>
            <translated>false</translated>
            <fields>
              <field>entryLabel</field>
            </fields>
          </widget>
          <widget name="sub1" type="text">
            <labels>
              <label mode="any">EntryName</label>
            </labels>
            <translated>false</translated>
            <fields>
              <field>entryName</field>
            </fields>
          </widget>
          <widget name="sub2" type="text">
            <labels>
              <label mode="any">EntryTyp</label>
            </labels>
            <translated>false</translated>
            <fields>
              <field>entryTyp</field>
            </fields>
          </widget>
        </subWidgets>
      </widget>
    </layout>
    <layout name="complexListForm@view">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>complexList</widget>
        </row>
      </rows>
      <widget name="complexList" type="list">
        <labels>
          <label mode="any">ComplexList</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:complexList</field>
        </fields>
        <properties widgetMode="edit">
          <property name="hideSubLabels">true</property>
        </properties>
        <properties widgetMode="view">
          <property name="hideSubLabels">true</property>
        </properties>
        <subWidgets>
          <widget name="sub0" type="text">
            <labels>
              <label mode="any">EntryLabel</label>
            </labels>
            <translated>false</translated>
            <fields>
              <field>entryLabel</field>
            </fields>
          </widget>
          <widget name="sub1" type="text">
            <labels>
              <label mode="any">EntryName</label>
            </labels>
            <translated>false</translated>
            <fields>
              <field>entryName</field>
            </fields>
          </widget>
          <widget name="sub2" type="text">
            <labels>
              <label mode="any">EntryTyp</label>
            </labels>
            <translated>false</translated>
            <fields>
              <field>entryTyp</field>
            </fields>
          </widget>
        </subWidgets>
      </widget>
    </layout>
    <layout name="compoundForm@create2">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml</template>
      </templates>
      <rows>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>layout</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>layout_1</widget>
        </row>
      </rows>
      <widget name="layout" type="layout">
        <labels>
          <label mode="any">Header</label>
        </labels>
        <translated>false</translated>
        <fields/>
        <properties widgetMode="edit">
          <property name="name">heading</property>
        </properties>
      </widget>
      <widget name="layout_1" type="layout">
        <labels>
          <label mode="any">Master</label>
        </labels>
        <translated>false</translated>
        <fields/>
        <properties widgetMode="edit">
          <property name="name">#{mode == 'edit'? 'masterForm@edit': (mode == 'create'? 'masterForm@create': 'masterForm@view')}</property>
        </properties>
      </widget>
    </layout>
    <layout name="compoundForm@edit">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>layout</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>layout_1</widget>
        </row>
      </rows>
      <widget name="layout" type="layout">
        <labels>
          <label mode="any">Layout</label>
        </labels>
        <translated>false</translated>
        <fields/>
        <properties widgetMode="edit">
          <property name="name">heading</property>
        </properties>
      </widget>
      <widget name="layout_1" type="layout">
        <labels>
          <label mode="any">Layout</label>
        </labels>
        <translated>false</translated>
        <fields/>
        <properties widgetMode="edit">
          <property name="name">#{mode == 'edit'? 'masterForm@edit': (mode == 'create'? 'masterForm@create': 'masterForm@view')}</property>
        </properties>
      </widget>
    </layout>
    <layout name="compoundForm@view">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>layout</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>layout_1</widget>
        </row>
      </rows>
      <widget name="layout" type="layout">
        <labels>
          <label mode="any">Layout</label>
        </labels>
        <translated>false</translated>
        <fields/>
        <properties widgetMode="edit">
          <property name="name">heading</property>
        </properties>
        <properties widgetMode="view">
          <property name="name">heading</property>
        </properties>
      </widget>
      <widget name="layout_1" type="layout">
        <labels>
          <label mode="any">Layout</label>
        </labels>
        <translated>false</translated>
        <fields/>
        <properties widgetMode="edit">
          <property name="name">#{mode == 'edit'? 'masterForm@edit': (mode == 'create'? 'masterForm@create': 'masterForm@view')}</property>
        </properties>
        <properties widgetMode="view">
          <property name="name">#{mode == 'edit'? 'masterForm@edit': (mode == 'create'? 'masterForm@create': 'masterForm@view')}</property>
        </properties>
      </widget>
    </layout>
    <layout name="masterForm@create">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>name</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>fieldA</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>fieldB</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>complexSelector</widget>
        </row>
      </rows>
      <widget name="name" type="text">
        <labels>
          <label mode="any">Name</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:name</field>
        </fields>
      </widget>
      <widget name="fieldA" type="text">
        <labels>
          <label mode="any">FieldA</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:fieldA</field>
        </fields>
      </widget>
      <widget name="fieldB" type="text">
        <labels>
          <label mode="any">FieldB</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:fieldB</field>
        </fields>
      </widget>
      <widget name="complexSelector" type="text">
        <labels>
          <label mode="any">ComplexSelector XXX</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:complexSelector</field>
        </fields>
        <properties widgetMode="edit">
          <property name="valueChangeListener">ComplexSelectorBean.valueChanged</property>
        </properties>
      </widget>
    </layout>
    <layout name="masterForm@edit">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>name</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>fieldA</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>fieldB</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>complexSelector</widget>
        </row>
      </rows>
      <widget name="name" type="text">
        <labels>
          <label mode="any">Name</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:name</field>
        </fields>
      </widget>
      <widget name="fieldA" type="text">
        <labels>
          <label mode="any">FieldA</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:fieldA</field>
        </fields>
      </widget>
      <widget name="fieldB" type="text">
        <labels>
          <label mode="any">FieldB</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:fieldB</field>
        </fields>
      </widget>
      <widget name="complexSelector" type="text">
        <labels>
          <label mode="any">ComplexSelector Edit </label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:complexSelector</field>
        </fields>
        <properties widgetMode="edit">
          <property name="valueChangeListener">ComplexSelectorBean.valueChanged</property>
        </properties>
      </widget>
    </layout>
    <layout name="masterForm@view">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>name</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>fieldA</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>fieldB</widget>
        </row>
        <row>
          <properties mode="any">
            <property name="nxl_colspan_0">1</property>
          </properties>
          <widget>complexSelector</widget>
        </row>
      </rows>
      <widget name="name" type="text">
        <labels>
          <label mode="any">Name</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:name</field>
        </fields>
      </widget>
      <widget name="fieldA" type="text">
        <labels>
          <label mode="any">FieldA</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:fieldA</field>
        </fields>
      </widget>
      <widget name="fieldB" type="text">
        <labels>
          <label mode="any">FieldB</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:fieldB</field>
        </fields>
      </widget>
      <widget name="complexSelector" type="text">
        <labels>
          <label mode="any">ComplexSelector</label>
        </labels>
        <translated>false</translated>
        <fields>
          <field>ds:complexSelector</field>
        </fields>
        <properties widgetMode="edit">
          <property name="valueChangeListener">ComplexSelectorBean.valueChanged</property>
        </properties>
      </widget>
    </layout>
  </extension>
  <extension target="org.nuxeo.ecm.platform.actions.ActionService" point="filters">
    <filter id="create" append="true">
      <rule grant="false">
        <type>demoType</type>
      </rule>
    </filter>
  </extension>
  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager" point="widgettypes">


    <documentation>Widget types declared in studio</documentation>


    <widgetType name="studio_header">

      <configuration>

        <title>Header</title>

        <description>
          The header widget just displays the widget label.
        </description>

        <supportedModes>

          <mode>edit</mode>

          <mode>view</mode>

        </supportedModes>

        <fields>

          <list>false</list>

          <complex>false</complex>

          <supportedTypes/>

          <defaultTypes/>

        </fields>

        <handlingLabels>true</handlingLabels>

        <categories>

          <category>document</category>

          <category>studio</category>

        </categories>

        <properties>

          <layouts mode="any">

            <layout name="studio_header_widget_type_properties_any">

              <rows>

                <row>

                  <widget>styleClass</widget>

                </row>

                <row>

                  <widget>style</widget>

                </row>

              </rows>

              <widget name="styleClass" type="text">

                <labels>

                  <label mode="any">Style class</label>

                </labels>

                <fields>

                  <field>styleClass</field>

                </fields>

              </widget>

              <widget name="style" type="text">

                <labels>

                  <label mode="any">Style</label>

                </labels>

                <fields>

                  <field>style</field>

                </fields>

              </widget>

            </layout>

          </layouts>

        </properties>

      </configuration>

      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>

      <property name="template">
        /widgets/studio_header_widget.xhtml
      </property>

    </widgetType>


    <widgetType name="filesList">

      <configuration>

        <title>Files</title>

        <description>

          <p>
            The Files displays an editable list of files, using javascript to
            keep the uploaded file path when adding several files in a row.
          </p>

          <p>Items are defined using sub wigdets configuration.</p>

          <p>
            This is actually a template widget type whose template uses a
            &lt;nxu:inputList /&gt; tag in edit or create mode, and a table
            iterating over items in other modes.
          </p>

        </description>

        <categories>

          <category>document</category>

          <category>studio</category>

        </categories>

        <supportedModes>

          <mode>edit</mode>

          <mode>view</mode>

        </supportedModes>

        <acceptingSubWidgets>true</acceptingSubWidgets>

        <fields>

          <list>true</list>

          <complex>false</complex>

          <supportedTypes>

            <type>blob</type>

          </supportedTypes>

          <defaultTypes>

            <type>blob</type>

          </defaultTypes>

        </fields>

        <properties>

          <layouts mode="edit">

            <layout name="list_widget_type_properties_edit">

              <rows>

                <row>

                  <widget>required</widget>

                </row>

                <row>

                  <widget>diff</widget>

                </row>

              </rows>

              <widget name="required" type="checkbox">

                <labels>

                  <label mode="any">Required</label>

                </labels>

                <fields>

                  <field>required</field>

                </fields>

              </widget>

              <widget name="diff" type="checkbox">

                <labels>

                  <label mode="any">Diff</label>

                </labels>

                <fields>

                  <field>diff</field>

                </fields>

              </widget>

            </layout>

          </layouts>

        </properties>

      </configuration>

      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>

      <property name="template">/widgets/files_list_widget_template.xhtml
      </property>

    </widgetType>


  </extension>
</component>
